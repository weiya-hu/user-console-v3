import{H as e,o as a,I as l,J as s,u as t,j as d,g as n,r as o,a as c,w as u,B as i,P as r,aa as p,c as m,a2 as _,a3 as f,a6 as v,ac as y,$ as b,a0 as h,a1 as g,av as k,aw as C}from"./vue.a499711c.js";import{c as V,d as x,e as w}from"./findB.e68a3db7.js";import{_ as E}from"./KzCascader.6a65f304.js";import{x as j,_ as U,m as z,D as N}from"./index.561f5261.js";const T=e({name:"CloseBold"}),K={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},L=[s("path",{fill:"currentColor",d:"M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"},null,-1)];var R=j(T,[["render",function(e,s,t,d,n,o){return a(),l("svg",K,L)}]]);const B=e=>(k("data-v-4432fe3b"),e=e(),C(),e),F={class:"search_components kz_card mb16"},I={class:"height_searchbox"},S={class:"topitems fcs"},q={class:"contact_mode fcs"},D={class:"fcs btns"},H=_("查询条件"),J=_("保存条件"),M=_("重置条件"),P={class:"fcs"},$={class:"fsc ditems"},A={class:"dname els"},G={class:"dbtns fcs"},O=["onClick"],Q=B((()=>s("div",{class:"dline"},null,-1))),W=B((()=>s("div",null,"选择",-1))),X={key:1,class:"empty_drop"},Y={class:"now_condition fcs"},Z=B((()=>s("div",{class:"fs0"},"筛选条件：",-1))),ee={class:"list flex"},ae={class:"flex fjend"},le=_("取消"),se=_("确认");var te=U(e({name:"KzTopSearch",emits:["close","search"],setup(e,{emit:k}){const C=z(),j=()=>{k("close")},U=t((()=>C.state.companyType)),T=t((()=>C.state.contactList)),K=d({ctype:[],industry_id:[],addr:[],business_scope:"",contact:[]}),L=n(),B=e=>{e&&e.resetFields()},te=()=>{pe.value="条件组",B(L.value),K.ctype.length=0,K.industry_id.length=0,K.addr.length=0,K.business_scope="",K.contact.length=0,be.business_scope="",be.industry_id="",be.addr="",be.contact="",be.ctype="",he.value=!1},de=n(!1),ne=d({title:""}),oe=n(),ce=d({title:[{required:!0,message:"请输入条件组名称",trigger:"change"}]}),ue=()=>{de.value=!1,B(oe.value)},ie=()=>{let e={},a=0,l=0;K.ctype.forEach((e=>{a|=Number(e)})),K.contact.forEach((e=>{l|=Number(e)}));const s=K.industry_id.join(",");return e={province:Number(K.addr[0])||"",city:Number(K.addr[1])||"",district:Number(K.addr[2])||"",business_scope:K.business_scope,industry_id:s,contact:l,company_type:a,conditions_name:ne.title},e},re=()=>{V(ie()).then((e=>{1==e.status&&(pe.value=ne.title,de.value=!1,_e())}))},pe=n("条件组"),me=n([]),_e=async()=>{const e=await x({current:1,size:10});1==e.status&&(me.value=e.body)};_e();const fe=n(),ve=e=>{te(),pe.value=e.conditions_name,T.value.forEach((a=>{e.contact&a.value&&K.contact.push(a.value)}));[e.province,e.city,e.district].forEach((e=>{e&&K.addr.push(Number(e))})),K.industry_id=e.industry_id.split(","),K.business_scope=e.business_scope,U.value.forEach((a=>{e.company_type&a.value&&K.ctype.push(a.value)})),ge()},ye={business_scope:"经营范围",industry_id:"行业分类",addr:"省份地区",contact:"联系方式",ctype:"企业类型"},be=d({business_scope:"",industry_id:"",addr:"",contact:"",ctype:""}),he=n(!1),ge=()=>{be.business_scope=K.business_scope;let e="",a="";K.contact.forEach((a=>{var l;e+=(null==(l=T.value.find((e=>e.value==a)))?void 0:l.name)+"，"})),be.contact=e.substring(0,e.length-1),K.ctype.forEach((e=>{var l;a+=(null==(l=U.value.find((a=>a.value==e)))?void 0:l.name)+"，"})),be.ctype=a.substring(0,a.length-1),be.industry_id=Ve.value.getText(K.industry_id),be.addr=Ce.value.getText(K.addr),he.value=!0},ke=e=>{switch(e){case"contact":let a="";K.contact.forEach((e=>{var l;a+=(null==(l=T.value.find((a=>a.value==e)))?void 0:l.name)+"，"})),be.contact=a.substring(0,a.length-1);break;case"ctype":let l="";K.ctype.forEach((e=>{var a;l+=(null==(a=U.value.find((a=>a.value==e)))?void 0:a.name)+"，"})),be.ctype=l.substring(0,l.length-1);break;case"industry_id":be.industry_id=Ve.value.getText(K.industry_id);break;case"addr":be.addr=Ce.value.getText(K.addr);break;default:be[e]=K[e]}he.value=!0},Ce=n(),Ve=n(),xe=()=>{k("search",ie())};return(e,t)=>{const d=o("el-icon"),n=o("el-input"),k=o("el-form-item"),C=o("el-checkbox"),V=o("el-checkbox-group"),x=o("el-button"),z=o("el-dropdown-item"),B=o("el-dropdown-menu"),ie=o("el-dropdown"),_e=o("el-form"),ge=o("el-tag"),we=o("el-collapse-transition"),Ee=o("el-dialog");return a(),l("div",F,[s("div",I,[c(d,{class:"closebtn rotate",size:"18px",onClick:j},{default:u((()=>[c(i(R))])),_:1}),c(_e,{ref_key:"formRef",ref:L,class:"myform",model:K,onKeyup:y(xe,["enter"])},{default:u((()=>[s("div",S,[c(k,{label:"经营范围",prop:"business_scope"},{default:u((()=>[c(n,{modelValue:K.business_scope,"onUpdate:modelValue":t[0]||(t[0]=e=>K.business_scope=e),placeholder:"请输入经营范围",maxlength:"36",onChange:t[1]||(t[1]=e=>ke("business_scope"))},null,8,["modelValue"])])),_:1}),c(k,{label:"行业分类",prop:"industry_id"},{default:u((()=>[c(E,{ref_key:"typeCRef",ref:Ve,modelValue:K.industry_id,"onUpdate:modelValue":t[2]||(t[2]=e=>K.industry_id=e),type:"type",onChange:t[3]||(t[3]=e=>ke("industry_id"))},null,8,["modelValue"])])),_:1}),c(k,{label:"省份地区",prop:"addr"},{default:u((()=>[c(E,{ref_key:"addrCRef",ref:Ce,modelValue:K.addr,"onUpdate:modelValue":t[4]||(t[4]=e=>K.addr=e),type:"address",onChange:t[5]||(t[5]=e=>ke("addr"))},null,8,["modelValue"])])),_:1})]),s("div",q,[c(k,{label:"联系方式",prop:"contact"},{default:u((()=>[c(V,{modelValue:K.contact,"onUpdate:modelValue":t[6]||(t[6]=e=>K.contact=e),onChange:t[7]||(t[7]=e=>ke("contact"))},{default:u((()=>[(a(!0),l(r,null,p(i(T),(e=>(a(),m(C,{key:e.id,label:e.value},{default:u((()=>[_(f(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})]),c(k,{label:"企业类型",prop:"ctype"},{default:u((()=>[c(V,{modelValue:K.ctype,"onUpdate:modelValue":t[8]||(t[8]=e=>K.ctype=e),onChange:t[9]||(t[9]=e=>ke("ctype"))},{default:u((()=>[(a(!0),l(r,null,p(i(U),(e=>(a(),m(C,{key:e.id,label:e.value},{default:u((()=>[_(f(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),s("div",D,[c(x,{type:"primary",onClick:xe},{default:u((()=>[H])),_:1}),c(x,{class:"bdc_btn",onClick:t[10]||(t[10]=e=>de.value=!0)},{default:u((()=>[J])),_:1}),c(x,{class:"bdc_btn",onClick:te},{default:u((()=>[M])),_:1}),c(ie,{ref_key:"dropRef",ref:fe,onCommand:ve},{dropdown:u((()=>[me.value.length?(a(),m(B,{key:0},{default:u((()=>[(a(!0),l(r,null,p(me.value,((e,l)=>(a(),m(z,{key:e.id,command:e},{default:u((()=>[s("div",$,[s("div",A,f(e.conditions_name),1),s("div",G,[s("div",{onClick:v((a=>((e,a)=>{w({id:e.id}).then((l=>{1==l.status&&(me.value.splice(a,1),fe.value.handleClose(),e.conditions_name==pe.value&&(pe.value="条件组"))}))})(e,l)),["stop"])},"删除",8,O),Q,W])])])),_:2},1032,["command"])))),128))])),_:1})):(a(),l("div",X,"暂无数据"))])),default:u((()=>[s("div",P,[s("div",null,f(pe.value),1),c(d,{class:"right_icon"},{default:u((()=>[c(i(N))])),_:1})])])),_:1},512)])])),_:1},8,["model","onKeyup"]),c(we,null,{default:u((()=>[b(s("div",Y,[Z,s("div",ee,[(a(!0),l(r,null,p(be,((e,s)=>(a(),l(r,null,[e?(a(),m(ge,{key:s,closable:"",class:"mytag",onClose:e=>(e=>{be[e]="","business_scope"==e?K.business_scope="":K[e]=[]})(s)},{default:u((()=>[_(f(ye[s])+"："+f(e),1)])),_:2},1032,["onClose"])):g("",!0)],64)))),256))])],512),[[h,he.value]])])),_:1})]),c(Ee,{modelValue:de.value,"onUpdate:modelValue":t[13]||(t[13]=e=>de.value=e),title:"新建筛选",width:"500px",onClose:ue},{footer:u((()=>[s("span",ae,[c(x,{onClick:ue},{default:u((()=>[le])),_:1}),c(x,{type:"primary",disabled:!ne.title,onClick:re},{default:u((()=>[se])),_:1},8,["disabled"])])])),default:u((()=>[c(_e,{ref_key:"addFormRef",ref:oe,class:"myform no_margin",model:ne,rules:ce,onSubmit:t[12]||(t[12]=v((()=>{}),["prevent"]))},{default:u((()=>[c(k,{label:"条件组名称",prop:"title"},{default:u((()=>[c(n,{modelValue:ne.title,"onUpdate:modelValue":t[11]||(t[11]=e=>ne.title=e),placeholder:"请输入条件组名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4432fe3b"]]);export{te as K};
