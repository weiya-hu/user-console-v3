import{K as e}from"./KzUpload.48a7e92e.js";import{_ as a,T as l,e as t}from"./index.81e0e33e.js";import{H as u,u as s,ay as o,j as r,g as d,b as i,ae as p,o as m,I as n,a as c,w as v,_ as A,B as f,J as g,k as b,a1 as V}from"./vue.fa004e33.js";import{d as y}from"./custom.afab129f.js";var w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAGNJREFUOE9jZCATMJKpjwGnxv///1czMDAwMTIyNmMzHJ/GqSANjIyM2YNM4////2sZGBgkkJxlB2UfQhJ7xsjI2Ar2AkwQGhhSBDS+gAXWUAwc9LiCBtY/WGCgy1M/yRFKwwCaai0PqJOyPgAAAABJRU5ErkJggg==";const h={class:"upload-users"},F={class:"myform"},_={class:"fcs fjend pb20"},x=V("取消"),z=V("提交");var k=a(u({props:{modelValue:{type:Boolean},type:null},emits:["update:modelValue","submitSuccess"],setup(a,{emit:u}){const V=a,w=s({get:()=>V.modelValue,set:e=>{u("update:modelValue",e)}});o();const k=r({title:[{required:!0,message:"请输入需求标题",trigger:"blur"}],desc:[{required:!0,message:"请输入需求描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch(U.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .zip、.rar、.7z 格式的文件"));break;default:l()}},trigger:"change"}]}),U=d("none"),j=d(),C=d(),J=d({title:"",desc:"",updateFile:""}),M=d(!1);d("");const S=()=>{j.value.resetFields(),C.value.clear(),u("update:modelValue",!1)},B=e=>{M.value?l().then((()=>{C.value.doAbort(),e()})).catch((()=>{})):e()},E=()=>{j.value.validate((e=>{if(!e)return!1;M.value=!0,J.value.updateFile?C.value.submit():I("")}))},G=e=>{e?(U.value=e,J.value.updateFile="",j.value.validateField("updateFile",(()=>null))):(U.value="",j.value.clearValidate("updateFile"))},R=e=>{J.value.updateFile="",U.value="none",C.value.clear(),M.value=!1,t("上传失败")},I=async e=>{const a=await y({attach_url:e,detail:J.value.desc,title:J.value.title},V.type);M.value=!1,1===a.status&&u("submitSuccess")};return(a,l)=>{const t=i("el-input"),u=i("el-form-item"),s=i("el-form"),o=i("el-button"),r=i("el-dialog"),d=p("loading");return m(),n("div",h,[c(r,{modelValue:f(w),"onUpdate:modelValue":l[3]||(l[3]=e=>b(w)?w.value=e:null),width:500,title:"创建需求","before-close":B,onClose:S},{default:v((()=>[A((m(),n("div",F,[c(s,{ref_key:"formRef",ref:j,model:J.value,rules:f(k),"label-width":"90px"},{default:v((()=>[c(u,{label:"需求标题",prop:"title"},{default:v((()=>[c(t,{modelValue:J.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>J.value.title=e),placeholder:"请输入需求标题"},null,8,["modelValue"])])),_:1}),c(u,{label:"需求描述",prop:"desc"},{default:v((()=>[c(t,{modelValue:J.value.desc,"onUpdate:modelValue":l[1]||(l[1]=e=>J.value.desc=e),type:"textarea",maxlength:"150","show-word-limit":"",rows:"5",resize:"none",placeholder:"简要描述您的具体需求，以及期望目标。"},null,8,["modelValue"])])),_:1}),c(u,{label:"文件上传",prop:"updateFile",style:{"margin-bottom":"20px"}},{default:v((()=>[c(e,{ref_key:"upload",ref:C,modelValue:J.value.updateFile,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value.updateFile=e),msg:"附件大小不超过4M<br/>支持.zip、.rar、.7z压缩包","exname-list":[".zip",".rar",".7z"],"max-size":4,onChange:G,onError:R,onSuccess:I},null,8,["modelValue","exname-list"])])),_:1})])),_:1},8,["model","rules"]),g("div",_,[c(o,{onClick:S},{default:v((()=>[x])),_:1}),c(o,{type:"primary",onClick:E},{default:v((()=>[z])),_:1})])])),[[d,M.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6245a1f2"]]);export{k as K,w as i};
