import{K as e}from"./KzEmpty.cf970ba3.js";import{f as a}from"./date.23847c74.js";import{K as l}from"./KzDialog.579e968a.js";import{x as t,_ as u,L as d,C as s,b as o,E as i,e as n,a2 as r}from"./index.e45ab2da.js";import{H as c,o as v,I as m,J as p,g as f,b as _,c as y,w as b,a as g,B as h,a2 as k,W as w,V,a1 as x,a0 as C,P as z,aa as L,av as U,aw as F,q as j}from"./vue.fa004e33.js";import{K}from"./KzPage.dd3597d0.js";import{a as S,b as M,d as R,c as I,e as B,f as E,g as O,h as H,i as T,j as q}from"./contact.16343763.js";import"./kzkf.70bb183f.js";import"./tinymce.50e98bcc.js";const D=c({name:"Edit"}),N={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},P=[p("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),p("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var $=t(D,[["render",function(e,a,l,t,u,d){return v(),m("svg",N,P)}]]);const A={class:"upbox"},J={key:0,class:"upvideo up_lt"},W=["src"],G={class:"fcc fc"},Q={class:"file_name"},X={class:"upbox"},Y={class:"up_rt"},Z=["innerHTML"],ee={key:0,class:"up_tip dfcolor fcs"},ae=x("下载模板示例"),le={key:1,class:"up_tip dfcolor"};var te=u(c({props:{modelValue:{default:""},exnameList:{default:()=>[".zip",".rar",".7z"]},downLink:{default:""},msg:{default:"可适当描述所处的行业现状，以及公司目前采取的运营、渠道、推广等多种获客方式，以便运营人员进一步了解熟悉您的所处的行业及需求，同时也为您提供更好的客户服务。"},type:{default:""},maxSize:{default:4}},emits:["update:modelValue","change","changeName"],setup(e,{expose:a,emit:l}){const t=e,u=f(),o=f({}),i=f(""),n=f("");f("");const r=f(""),c=f(),z=e=>{u.value.clearFiles(),u.value.handleStart(e[0]),F.value=void 0},L=f(),U=(e,a)=>{if(!e.name||"fail"===e.status)return;L.value=e;const u=e.name.lastIndexOf("."),d=e.name.substring(u);t.exnameList.indexOf(d)<0?l("change","type"):e.size&&e.size/1024/1024>t.maxSize?l("change","size"):(l("change",""),l("update:modelValue",e.raw),c.value=e.name,n.value=d,"video"===t.type&&(!r.value&&l("changeName",e.name.substring(0,u)),r.value=URL.createObjectURL(e.raw)))},F=f(),j=()=>{};return a({clear:()=>{u.value.clearFiles(),L.value=void 0,F.value=void 0,c.value=void 0,l("update:modelValue",""),URL.revokeObjectURL(r.value),r.value=""}}),(a,l)=>{const t=_("el-icon"),n=_("el-link"),f=_("el-upload");return v(),y(f,{ref_key:"upload",ref:u,drag:"",action:i.value,"auto-upload":!1,limit:1,multiple:!1,"show-file-list":!1,data:o.value,"on-exceed":z,"on-change":U,accept:e.exnameList.join(","),class:"my_upload"},{default:b((()=>[p("div",A,["video"===e.type&&e.modelValue?(v(),m("div",J,[p("video",{src:r.value},null,8,W)])):(v(),m("div",{key:1,class:w(["fcc up_lt",e.modelValue?"hasfile":""])},[p("div",G,[g(t,null,{default:b((()=>[e.modelValue?(v(),y(h(d),{key:0})):(v(),y(h(s),{key:1}))])),_:1}),p("div",Q,k(c.value||"拖拽/点击上传"),1)])],2))])])),tip:b((()=>[p("div",X,[V(a.$slots,"default",{},(()=>[p("div",Y,[p("div",{innerHTML:e.msg},null,8,Z),e.downLink?(v(),m("div",ee,[g(n,{type:"primary",href:e.downLink,download:"模板.xlsx",onClick:j},{default:b((()=>[ae])),_:1},8,["href"]),x("（上传附件大小不超过"+k(e.maxSize)+"M） ",1)])):C("",!0),e.downLink||"video"==e.type?C("",!0):(v(),m("div",le," 附件支持 "+k(e.exnameList.join(" "))+"，大小不超过"+k(e.maxSize)+"M ",1))])]),!0)])])),_:3},8,["action","data","accept"])}}}),[["__scopeId","data-v-5bd2ef5e"]]);const ue=e=>(U("data-v-0324132a"),e=e(),F(),e),de={class:"send_list"},se={class:"flexb send_list_top"},oe=ue((()=>p("div",null,"联系人",-1))),ie={class:"flexr"},ne=x("查询"),re=x("导入联系人"),ce=x("分组管理"),ve=x(" 新建  "),me={class:"dmp_table"},pe={class:"fcs"},fe=x("发送短信"),_e=ue((()=>p("div",{class:"line"},null,-1))),ye=x("修改"),be=ue((()=>p("div",{class:"line"},null,-1))),ge=x("删除"),he={class:"type-tips"},ke=ue((()=>p("div",{class:"tips-nav"},[
p("span",null,"分组管理")],-1))),we={class:"bbtns flexr"},Ve=x("添加"),xe={class:"dragbox"},Ce={key:0,class:"typeAdd"},ze={class:"cz"},Le=x("取消"),Ue=x("确认"),Fe={class:"items"},je={class:"txt"},Ke={class:"handle"},Se={key:0,class:"fcs fjend imgicon"},Me={style:{flex:"auto"}},Re=x("取消"),Ie=x("确定"),Be={class:"flexl up_file"},Ee=ue((()=>p("div",null,"上传附件",-1))),Oe={class:"upload_pre"},He={class:"up_file_describ"},Te=ue((()=>p("div",null,[
p("div",null,"1：下载模板，根据模板要求填写号码；"),
p("div",null,"2：上传填写后的模板文件；"),
p("div",null,"3：点击确认按钮；")],-1))),qe=x("下载模板示例");var De=u(c({setup(t){const u=f(1),d=f(10),s=f(0),c=f(),w=f("none"),V=f(),U=f(),F=f(),D=f(!1),N=f(),P=f(),A=f({name:"",group_id:null,mobile:""}),J=f(),W=f({addFile:""}),G=f({name:[{required:!0,message:"请输入姓名",trigger:"change"}],group_id:[{required:!0,message:"请选择分组",trigger:"change"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:o,trigger:"blur"}]}),Q=f({addFile:[{validator:(e,a,l)=>{switch(w.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .csv 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),X=async e=>{const a={current:u.value,size:d.value,str:e},{status:l,body:t}=await S(a);l&&(F.value=t.records,s.value=t.total)};X();const Y=()=>{D.value=!0,c.value="新建联系人",ee(),j((()=>{N.value.resetFields()}))},Z=()=>{const e="编辑联系人"===c.value;N.value.validate((async a=>{if(a){const{status:a}=e?await M(A.value):await R(A.value);a&&(X(),D.value=!1)}}))},ee=async()=>{const{status:e,body:a}=await I();e&&(P.value=a)},ae=()=>{A.value={name:"",group_id:null,mobile:""},N.value.resetFields()},le=f({}),ue=f(""),De=f(!1),Ne=f("rtl"),Pe=f(!1),$e=f(!1),Ae=f(!1),Je=()=>{De.value=!1},We=()=>{Pe.value=!Pe.value},Ge=async()=>{const{status:e}=await E({name:ue.value});e&&(ee(),Pe.value=!1,ue.value="")},Qe=async()=>{const e={id:le.value},{status:a}=await O(e);a&&(ee(),$e.value=!1)},Xe=async()=>{const e={name:ue.value,id:le.value},{status:a}=await H(e);a&&(ee(),Ae.value=!1)},Ye=f(),Ze=f(!1),ea=e=>{e?(w.value=e,W.value.addFile="",J.value.validateField("addFile",(()=>null))):(w.value="",J.value.clearValidate("updateFile"))},aa=()=>{J.value.validate((async e=>{e&&(async()=>{const e=new FormData;e.append("file",W.value.addFile);const{status:a,message:l}=await q(e);a?(Ze.value=!1,i.alert(l,"提示",{confirmButtonText:"OK",callback:()=>{X()}})):n(l)})()}))};return(t,o)=>{const n=_("el-input"),f=_("el-button"),w=_("KzIcon"),j=_("el-table-column"),S=_("el-link"),M=_("el-table"),R=_("el-form-item"),I=_("el-option"),E=_("el-select"),O=_("el-form"),H=_("el-icon"),q=_("el-tooltip"),la=_("el-drawer");return v(),m("div",de,[p("div",se,[oe,p("div",ie,[g(n,{modelValue:U.value,"onUpdate:modelValue":o[0]||(o[0]=e=>U.value=e),placeholder:"请输入姓名/电话号码搜索",class:"search_inpt",clearable:"",onInput:o[1]||(o[1]=()=>{!U.value&&X()}),onKeydown:o[2]||(o[2]=e=>X(U.value))},null,8,["modelValue"]),g(f,{class:"bdc_btn",onClick:o[3]||(o[3]=e=>X(U.value))},{default:b((()=>[ne])),_:1}),g(f,{class:"bdc_btn",onClick:o[4]||(o[4]=()=>{Ze.value=!0,(async()=>{const e=await T();Ye.value=URL.createObjectURL(e)})()})},{default:b((()=>[re])),_:1}),g(f,{class:"bdc_btn",onClick:o[5]||(o[5]=()=>{De.value=!0,ee()})},{default:b((()=>[ce])),_:1}),g(f,{type:"primary",onClick:Y},{default:b((()=>[g(w,{href:"#icon-tianjia",size:"14px",color:"white",class:"add_need_icon"}),ve])),_:1})])]),p("div",me,[g(M,{data:F.value,style:{width:"100%"}},{empty:b((()=>[g(e)])),default:b((()=>[g(j,{property:"name",label:"联系人姓名","min-width":"100"}),g(j,{property:"group_name",label:"联系人分组","min-width":"100"}),g(j,{property:"mobile",label:"电话号码","min-width":"120"}),g(j,{property:"create_time",label:"添加时间","min-width":"120"},{default:b((({row:e})=>[p("div",null,k(h(a)(new Date(e.create_time),"yyyy-MM-dd hh:mm")),1)])),_:1}),g(j,{label:"操作",fixed:"right",width:"250"},{default:b((({row:e})=>[p("div",pe,[g(S,{type:"primary",onClick:a=>t.$router.push("/product/notification/sms/addsend?mobile="+e.mobile+"&name="+e.name+"&contactId="+e.id)},{default:b((()=>[fe])),_:2},1032,["onClick"]),_e,g(S,{type:"primary",onClick:a=>(e=>{ee(),A.value=e,c.value="编辑联系人",D.value=!0})(e)},{default:b((()=>[ye])),_:2},1032,["onClick"]),be,g(S,{type:"primary",onClick:a=>(e=>{i.confirm("是否确认删除联系人："+e.name,"操作提示",{showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"确认"}).then((async()=>{const{status:a}=await B({id:e.id});a&&X()})).catch((()=>{}))})(e)},{default:b((()=>[ge])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),g(K,{page:u.value,"onUpdate:page":o[6]||(o[6]=e=>u.value=e),size:d.value,"onUpdate:size":o[7]||(o[7]=e=>d.value=e),total:s.value,onChange:o[8]||(o[8]=e=>X(U.value))},null,8,["page","size","total"])]),g(l,{modelValue:D.value,"onUpdate:modelValue":o[12]||(o[12]=e=>D.value=e),width:"470px",title:c.value,onSure:Z,onClose:ae},{default:b((()=>[g(O,{ref_key:"formRef",ref:N,model:A.value,rules:G.value},{default:b((()=>[g(R,{label:"联系人姓名",prop:"name"},{default:b((()=>[g(n,{modelValue:A.value.name,"onUpdate:modelValue":o[9]||(o[9]=e=>A.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),g(R,{label:"联系人分组",prop:"group_id"},{default:b((()=>[g(E,{modelValue:A.value.group_id,"onUpdate:modelValue":o[10]||(o[10]=e=>A.value.group_id=e),placeholder:"请选择分组",class:"group_select"},{default:b((()=>[(v(!0),m(z,null,L(P.value,(e=>(v(),y(I,{key:e.id,value:e.id,label:e.name},{default:b((()=>[x(k(e.name),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(R,{label:"   电话号码",prop:"mobile"},{default:b((()=>[g(n,{modelValue:A.value.mobile,"onUpdate:modelValue":o[11]||(o[11]=e=>A.value.mobile=e),placeholder:"请输入电话号码"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),p("div",he,[g(la,{modelValue:De.value,"onUpdate:modelValue":o[14]||(o[14]=e=>De.value=e),direction:Ne.value,size:"480"},{header:b((()=>[ke])),default:b((()=>[p("div",we,[g(f,{type:"primary",class:"bdc_btn type-add",plain:"",onClick:We},{default:b((()=>[Ve])),_:1})]),p("div",xe,[Pe.value?(v(),m("div",Ce,[g(n,{modelValue:ue.value,"onUpdate:modelValue":o[13]||(o[13]=e=>ue.value=e),class:"type-input",clearable:"true"},null,8,["modelValue"]),p("div",ze,[g(f,{type:"primary",class:"bdc_btn",plain:"",onClick:We},{default:b((()=>[Le])),_:1}),g(f,{type:"primary",class:"",onClick:Ge},{default:b((()=>[Ue])),_:1})])])):C("",!0),(v(!0),m(z,null,L(P.value,((e,a)=>(v(),m("div",{key:e.id},[p("div",Fe,[p("div",je,k(e.name),1),p("div",Ke,[0!==a?(v(),m("div",Se,[g(q,{effect:"dark",content:"修改名称",placement:"bottom"},{default:b((()=>[g(H,{class:"chover",size:"18px","margin-right":"5px",onClick:a=>{return l=e,le.value=l.id,ue.value=l.name,void(Ae.value=!0);var l}},{default:b((()=>[g(h($))])),_:2},1032,["onClick"])])),_:2},1024),g(q,{effect:"dark",content:"删除",placement:"bottom"},{default:b((()=>[g(H,{class:"chover",size:"18px","margin-right":"5px",onClick:a=>{return l=e,le.value=l.id,ue.value=l.name,void($e.value=!0);var l}},{default:b((()=>[g(h(r))])),_:2},1032,["onClick"])])),_:2},1024)])):C("",!0)])])])))),128))])])),footer:b((()=>[p("div",Me,[g(f,{onClick:Je},{default:b((()=>[Re])),_:1}),g(f,{type:"primary",onClick:Je},{default:b((()=>[Ie])),_:1})])])),_:1},8,["modelValue","direction"])]),g(l,{modelValue:Ae.value,"onUpdate:modelValue":o[16]||(o[16]=e=>Ae.value=e),title:"修改分组",width:"380px",onClose:o[17]||(o[17]=e=>ue.value=""),onSure:Xe},{default:b((()=>[g(n,{modelValue:ue.value,"onUpdate:modelValue":o[15]||(o[15]=e=>ue.value=e),placeholder:"请输入分组名称"},null,8,["modelValue"])])),_:1},8,["modelValue"]),g(l,{modelValue:$e.value,"onUpdate:modelValue":o[18]||(o[18]=e=>$e.value=e),msg:"确认删除分组 “ "+ue.value+" ” ?",onSure:Qe},null,8,["modelValue","msg"]),g(l,{modelValue:Ze.value,"onUpdate:modelValue":o[20]||(o[20]=e=>Ze.value=e),title:"导入联系人",width:"470px",onSure:aa,onClose:o[21]||(o[21]=()=>{V.value.clear()})},{default:b((()=>[p("div",Be,[Ee,p("div",Oe,[g(O,{ref_key:"upFileFormRef",ref:J,model:W.value,rules:Q.value},{default:b((()=>[g(R,{prop:"addFile"},{default:b((()=>[g(te,{ref_key:"upFile",ref:V,modelValue:W.value.addFile,"onUpdate:modelValue":o[19]||(o[19]=e=>W.value.addFile=e),"exname-list":[".csv"],onChange:ea},{default:b((()=>[p("div",He,[Te,g(S,{class:"download_url",type:"primary",href:Ye.value,download:"模板.csv"},{default:b((()=>[qe])),_:1},8,["href"])])])),_:1},8,["modelValue","exname-list"])])),_:1})])),_:1},8,["model","rules"])])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0324132a"]]);export{De as default};
