var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{f as d}from"./date.23847c74.js";import{K as o}from"./KzEmpty.e7d92402.js";import{K as i}from"./KzPage.e5833c31.js";import{m as p,B as n,O as c,P as v,R as m,e as y,T as f}from"./index.a5da46a5.js";import{c as b,a as g,b as _}from"./seekPathPro.5279a52c.js";import{K as h}from"./KzDmpTitle.9f1696b6.js";import{K as w}from"./KzDialog.268c77a5.js";import{K as k}from"./KzUpload.fb7d1970.js";import{_ as V}from"./KzCascader.959798c6.js";import{H as j,g as x,u as z,j as F,o as C,I as K,J as U,a as q,w as O,B as P,_ as T,c as E,a2 as D,W as S,a0 as H,a1 as I,b as M,ae as B}from"./vue.fa004e33.js";import"./tinymce.50e98bcc.js";import"./kzkf.83b11867.js";const N={class:"kz_card dmp_page"},R={class:"fsc mb20"},J=I("新增需求"),W={class:"dmp_table"},$={style:{width:"100px"}},A={class:"els"},G={style:{width:"100px"},class:"fcc"},L={class:"els2"},Q={style:{width:"100px"},class:"fcc"},X={class:"els2"},Y={class:"fcs"},Z={class:"fcs"},ee=I("详情"),ae=I("---"),le=I("驳回原因"),te=I("下载附件"),re={key:4,class:"line"},ue=I("删除"),se={class:"flexr"},de=I("取消"),oe=I("确认"),ie=j((pe=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))u.call(a,l)&&s(e,l,a[l]);return e})({},{name:"SeekPath"}),a(pe,l({setup(e){const a=p(),l=x(a.state.addressHash),t=z((()=>a.state.typeHash)),r=x([]),u=x(0),s=x(10),j=x(1),I=x(!1),ie=async()=>{I.value=!0;const e={current:j.value,type:1,size:s.value},{status:a,body:l}=await b(e);I.value=!1,a&&(u.value=l.total,r.value=l.records)};ie();const pe=x(!1),ne=x(""),ce=x(!1),ve=x(""),me=async()=>{const{status:e}=await g({id:ve.value});1===e&&(ce.value=!1,ie())},ye=x(!1),fe=x(!1),be=x(),ge=x(),_e=x({industryType:[],country:[],name:"",desc:"",updateFile:""}),he=x(),we=F({industryType:[{required:!0,message:"请选择行业分类",trigger:"blur"}],country:[{required:!0,message:"请选择地区",trigger:"blur"}],name:[{required:!0,message:"请输入渠道名称",trigger:"change"},{required:!0,message:"请输入渠道名称",trigger:"blur"}],desc:[{required:!0,message:"请输入渠道描述",trigger:"change"},{required:!0,message:"请输入渠道描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch(he.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf、.xls、.xlsx 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),ke=e=>{e?(he.value=e,_e.value.updateFile="",be.value.validateField("updateFile",(()=>null))):(he.value="",be.value.clearValidate("updateFile"))},Ve=e=>{_e.value.updateFile="",he.value="none",ge.value.clear(),ye.value=!1,y("上传失败")},je=e=>{_({attachment:e||"",group_desc:_e.value.desc,group_name:_e.value.name,type:1,province:_e.value.country[0],city:_e.value.country[1],district:_e.value.country[2],industry_id:_e.value.industryType.join(",")}).then((e=>{e.status?(fe.value=!1,be.value.resetFields(),j.value=1,ie()):(_e.value.updateFile="",ge.value.clear()),ye.value=!1})).catch((()=>{ye.value=!1,Ve()}))},xe=()=>{be.value.validate((e=>{if(!e)return!1;ye.value=!0,_e.value.updateFile?ge.value.submit():je()}))},ze=e=>{ye.value?f().then((()=>{e()})).catch((()=>{})):e()},Fe=()=>{ye.value=!1,he.value="none",ge.value.clear(),be.value.resetFields()};return(e,a)=>{const p=M("el-button"),y=M("el-table-column"),f=M("el-tooltip"),b=M("el-link"),g=M("el-table"),_=M("el-form-item"),x=M("el-input"),z=M("el-form"),F=M("el-dialog"),he=B("loading");return C(),K("div",N,[U("div",R,[q(h),q(p,{type:"primary",icon:P(n),onClick:a[0]||(a[0]=e=>fe.value=!0)},{default:O((()=>[J])),_:1},8,["icon"])]),U("div",W,[T((C(),E(g,{data:r.value,size:"large"},{empty:O((()=>[q(o)])),default:O((()=>[q(y,{type:"selection",width:"50"}),q(y,{property:"id",label:"ID"}),q(y,{property:"type",label:"行业分类",width:"150"},{default:O((e=>[U("div",null,D(P(c)(e.row.industry_id.split(","),P(t),"last")),1)])),_:1}),q(y,{label:"地区",width:"180"},{default:O((({row:e})=>[q(f,{effect:"dark",placement:"top"},{content:O((()=>[U("div",$,D(e.province>0&&P(c)(P(v)(e.province,e.city,e.district),l.value)),1)])),default:O((()=>[U("div",A,D(e.province>0&&P(c)(P(v)(e.province,e.city,e.district),l.value)),1)])),_:2},1024)])),_:1}),q(y,{property:"group_name",label:"渠道名称",width:"200"},{default:O((({row:e})=>[q(f,{effect:"dark",placement:"top"},{content:O((()=>[U("div",G,D(e.group_name),1)])),default:O((()=>[U("div",L,D(e.group_name),1)])),_:2},1024)])),_:1}),q(y,{property:"group_desc",label:"渠道描述",width:"300"},{default:O((({row:e})=>[q(f,{effect:"dark",placement:"top"},{content:O((()=>[U("div",Q,D(e.group_name),1)])),default:O((()=>[U("div",X,D(e.group_name),1)])),_:2},1024)])),_:1}),q(y,{property:"create_time",label:"发起时间",width:"155"},{default:O((({row:e})=>[U("div",null,D(P(d)(new Date(Number(e.create_time)),"yyyy-MM-dd")),1)])),_:1}),q(y,{property:"status",label:"状态",width:"100"},{default:O((({row:e})=>[U("div",Y,[U("div",{class:S(["status_dot",P(m)(e.status).className])},null,2),U("div",null,D(P(m)(e.status).text),1)])])),_:1}),q(y,{property:"user_name",label:"创建人"}),q(y,{label:"操作",width:"150",fixed:"right"},{default:O((({row:a})=>[U("div",Z,[4===a.status?(C(),E(b,{key:0,type:"primary",onClick:l=>e.$router.push("/product/dmp/seekpathpro/seekpathdetails?id="+a.id)},{default:O((()=>[ee])),_:2},1032,["onClick"])):H("",!0),2===a.status?(C(),E(b,{key:1,type:"primary"},{default:O((()=>[ae])),_:1})):H("",!0),3===a.status?(C(),E(b,{key:2,type:"primary",onClick:e=>{return l=a.fail_reason,ne.value=l,void(pe.value=!0);var l}},{default:O((()=>[le])),_:2},1032,["onClick"])):H("",!0),1===a.status&&a.attachment?(C(),E(b,{key:3,type:"primary",href:a.attachment},{default:O((()=>[te])),_:2},1032,["href"])):H("",!0),2!==a.status&&a.attachment?(C(),K("div",re)):H("",!0),2!==a.status?(C(),E(b,{key:5,type:"primary",onClick:e=>{return l=a.id,ve.value=l,void(ce.value=!0);var l}},{default:O((()=>[ue])),_:2},1032,["onClick"])):H("",!0)])])),_:1})])),_:1},8,["data"])),[[he,I.value]])]),q(i,{page:j.value,"onUpdate:page":a[1]||(a[1]=e=>j.value=e),size:s.value,"onUpdate:size":a[2]||(a[2]=e=>s.value=e),total:u.value,onChange:ie},null,8,["page","size","total"]),q(w,{modelValue:pe.value,"onUpdate:modelValue":a[3]||(a[3]=e=>pe.value=e),title:"拒绝原因",msg:ne.value,btn:1},null,8,["modelValue","msg"]),q(w,{modelValue:ce.value,"onUpdate:modelValue":a[4]||(a[4]=e=>ce.value=e),msg:"确认删除这条数据吗?",onSure:me},null,8,["modelValue"]),q(F,{modelValue:fe.value,"onUpdate:modelValue":a[11]||(a[11]=e=>fe.value=e),width:500,draggable:"",title:"新增需求","before-close":ze,onClose:Fe},{footer:O((()=>[U("div",se,[q(p,{disabled:ye.value,onClick:a[10]||(a[10]=e=>fe.value=!1)},{default:O((()=>[de])),_:1},8,["disabled"]),q(p,{type:"primary",disabled:ye.value,onClick:xe},{default:O((()=>[oe])),_:1},8,["disabled"])])])),default:O((()=>[U("div",null,[T((C(),E(z,{ref_key:"formRef",ref:be,model:_e.value,rules:P(we),"label-width":"80px"},{default:O((()=>[q(_,{label:"行业分类",required:"",prop:"industryType"},{default:O((()=>[q(V,{modelValue:_e.value.industryType,"onUpdate:modelValue":a[5]||(a[5]=e=>_e.value.industryType=e),type:"type"},null,8,["modelValue"])])),_:1}),q(_,{label:"选择地区",required:"",prop:"country"},{default:O((()=>[q(V,{modelValue:_e.value.country,"onUpdate:modelValue":a[6]||(a[6]=e=>_e.value.country=e),type:"country"},null,8,["modelValue"])])),_:1}),q(_,{label:"渠道名称",required:"",prop:"name"},{default:O((()=>[q(x,{modelValue:_e.value.name,"onUpdate:modelValue":a[7]||(a[7]=e=>_e.value.name=e),placeholder:"请输入渠道名称",clearable:""},null,8,["modelValue"])])),_:1}),q(_,{label:"渠道描述",required:"",prop:"desc"},{default:O((()=>[q(x,{modelValue:_e.value.desc,"onUpdate:modelValue":a[8]||(a[8]=e=>_e.value.desc=e),type:"textarea",maxlength:"150",rows:"4","show-word-limit":"",placeholder:"请对寻找的渠道进行简要的描述（比如找分销代理，商业服务，经销贸易等）"},null,8,["modelValue"])])),_:1}),q(_,{label:"上传附件",prop:"updateFile"},{default:O((()=>[q(k,{ref_key:"upload",ref:ge,modelValue:_e.value.updateFile,"onUpdate:modelValue":a[9]||(a[9]=e=>_e.value.updateFile=e),site:"dmp_attach",onChange:ke,onError:Ve,onSuccess:je},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[he,ye.value]])])])),_:1},8,["modelValue"])])}}}))));var pe;export{ie as default};
