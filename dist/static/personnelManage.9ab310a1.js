var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s;import{H as i,g as n,j as d,u as c,o as v,I as r,J as m,a2 as p,a as _,w as f,B as g,W as b,P as y,aa as V,_ as w,$ as k,a1 as h,av as C,aw as x,ax as j,b as U,c as z}from"./vue.a94c4214.js";import{K as $}from"./KzPage.93c7f22b.js";import{K as I}from"./KzEmpty.72e49576.js";import{a as O}from"./areaNum.1f3b05a6.js";import{Q as P}from"./qrcode.vue.esm.919c0f63.js";import{u as K}from"./index.e4086819.js";import{_ as E,m as q,A as N,o as B,e as D,g as H,Z as L,t as M}from"./index.00a686cf.js";import{b as A,c as F,m as J,d as Q,s as R,e as S,f as W,h as Z,r as G,i as T,j as X,k as Y}from"./personnelManage.056ba4d5.js";import"./tinymce.a8dd01a6.js";const ee=e=>(C("data-v-be1603d2"),e=e(),x(),e),ae={class:"manager_tab flex"},le={class:"left_1"},se={class:"sel"},ue=h("添加分组"),te={class:"tree_sector"},oe=[ee((()=>m("div",{class:"left_line"},null,-1))),ee((()=>m("div",null,"全部人员",-1)))],ie=["onClick"],ne=ee((()=>m("div",{class:"left_line"},null,-1))),de=["onClick"],ce=[ee((()=>m("span",null,"修改名称",-1)))],ve=["onClick"],re=[ee((()=>m("span",null,"删除分组",-1)))],me={class:"dialog-footer"},pe=h("取消"),_e=h("保存"),fe={class:"dialog-footer"},ge=h("取消"),be=h("保存"),ye={class:"mid"},Ve={class:"fsc f1"},we={key:0},ke={class:"mid_title"},he={key:1,class:"flex"},Ce=h("保存"),xe=h("删除分组"),je=h("添加人员"),Ue={class:"mana_tab"},ze={class:"fcs line_last"},$e=h("编辑"),Ie=ee((()=>m("span",{class:"line"},null,-1))),Oe=h("删除"),Pe={class:"fcc"},Ke=h("二维码邀请"),Ee=h("链接邀请"),qe={key:0,class:"mid_dig"},Ne=ee((()=>m("div",{class:"fleximg mare type_face"},"邀请员工微信扫描下方二维码注册",-1))),Be={class:"img"},De=h("刷新二维码"),He={class:"fcc"},Le=h("下载二维码"),Me={key:1,class:"mid_dig"},Ae=ee((()=>m("div",{class:"fleximg type_face"},"点击复制以下链接，发送给员工",-1))),Fe={class:"link_code"},Je={class:"fcc"},Qe=h("复制链接"),Re={key:2,class:"mid_dig"},Se=ee((()=>m("div",{class:"fleximg mare type_face"},"请填写受邀请人员信息",-1))),We=ee((()=>m("div",{class:"fleximg mes"},"系统将通过短信邀请对方注册",-1))),Ze={class:"num"},Ge={class:"fcc"},Te=h("发送短信"),Xe={class:"sel_two"},Ye=ee((()=>m("span",{class:"grouping"},"名字",-1))),ea={class:"sel_two"},aa=ee((()=>m("span",{class:"grouping"},"电话",-1))),la={class:"sel_two"},sa=ee((()=>m("span",{class:"grouping"},"分组",-1))),ua={class:"sel_two"},ta=ee((()=>m("span",{class:"grouping"},"角色",-1))),oa={class:"sel_two"},ia=ee((()=>m("span",{class:"grouping"},"状态",-1))),na={class:"fjend"},da=h("取消"),ca=h("保存"),va=i((ra=((e,a)=>{for(var l in a||(a={}))u.call(a,l)&&o(e,l,a[l]);if(s)for(var l of s(a))t.call(a,l)&&o(e,l,a[l]);return e})({},{name:"PersonnelManage"}),ma={setup(e){const a=j(),l=q(),s=n(1),u=n(20),t=n(50),o=n([]),i=n(),C=d({tel:"",msg:""}),x=n(!1),E=n(1),ee=n(""),va=n(!0),ra=n({}),ma=n(!1),pa=n(!1),_a=n(!1),fa=n(0),ga=n(!0),ba=n(),ya=n(),Va=n(!0),wa=n(),ka=n(""),ha=n(""),Ca=n([]),xa=n(),ja=n(""),Ua=n(""),za=n("86"),$a=n(),Ia=n(),Oa=n(""),Pa=n(),Ka=c((()=>l.state.yxtUrl.mobile)),Ea=n(""),qa=async()=>{const{body:e}=await A();$a.value=e.cid,Ia.value=e.left_time,Oa.value=e.sign,Pa.value=e.uid,Ea.value="https://"+Ka.value+`/app/login?uid=${Pa.value}&sign=${Oa.value}&left_time=${Ia.value}&cid=${$a.value}`,Ma()},Na=async()=>{x.value=!0,qa()},Ba=n(),Da=()=>{const e=document.getElementById("qrImg"),a=document.createElement("a");a.href=e.toDataURL("image/png"),a.download="邀请二维码",a.click(),B("下载完成"),Ya()},Ha=n(""),La=n(""),Ma=()=>{Ha.value=window.location.origin+"/invite",La.value=window.location.origin+`/invite?uid=${Pa.value}&sign=${Oa.value}&left_time=${Ia.value}&cid=${$a.value}`},{toClipboard:Aa}=K(),Fa=()=>{ha.value="",ma.value=!1},Ja=()=>{ka.value="",pa.value=!1},Qa=async(e,a)=>{const{status:l}=await J({group_id:wa.value,name:ka.value});1===l?B("修改名称成功"):D("修改名称失败"),Ja(),al()},Ra=async(e,a)=>{const{status:l}=await J({group_id:ba.value,name:ee.value});1===l?B("修改名称成功"):D("修改名称失败"),va.value=!0,Ja(),al()},Sa=async e=>{const{status:l}=await Q({group_id:ba.value});1===l?B("删除分组成功"):D("删除分组失败"),a.push("/manage/company/personnelmanage"),al()},Wa=n(),Za=n([]),Ga=n(),Ta=async()=>{const{status:e}=await G({group_ids:Ca.value,role_ids:Za.value,user_status:fa.value,member_id:Ga.value,name:Ua.value});1==e&&(Xa(),ll(ba.value))},Xa=()=>{Ca.value=[],Za.value=[],Ua.value="",ja.value="",fa.value=0,_a.value=!1},Ya=()=>{C.msg="",3==E.value&&i.value.resetFields(),x.value=!1,E.value=1},el=d({tel:[{required:!0,message:"请输入手机号！",trigger:"blur"},{validator:(e,a,l)=>{M.test(a)?l():l(new Error("请输入正确的手机号码!"))},trigger:"blur"}]}),al=async()=>{const{body:e,status:l}=await W();if(l){ra.value=e;const l=H("id")||null;a.push(`/manage/company/personnelmanage?id=${l}`),ba.value=l,l?ll(Number(l),e[l]):ll()}(async()=>{const{status:e,message:a}=await Y();e&&(Ba.value=a)})()};al();const ll=async(e,i)=>{i&&(ee.value=i),ba.value=e;const{body:n,status:d}=await X({size:u.value,current:s.value,groupId:e});d&&(o.value=n.records,t.value=n.total,l.setKeepList([]),a.push(`/manage/company/personnelmanage?id=${e}`)),ga.value=!e,Va.value=!e,ya.value=e};return(e,l)=>{const n=U("el-icon"),d=U("el-button"),c=U("el-popover"),j=U("el-input"),K=U("el-dialog"),q=U("KzIcon"),H=U("el-table-column"),M=U("el-switch"),A=U("el-table"),J=U("el-button-group"),G=U("el-descriptions-item"),X=U("el-descriptions"),Y=U("el-option"),$a=U("el-select"),Ia=U("el-form-item"),Oa=U("el-form");return v(),r("div",ae,[m("div",le,[m("div",se,p(Ba.value),1),_(d,{class:"bdc_btn",onClick:l[0]||(l[0]=e=>ma.value=!0)},{default:f((()=>[_(n,{color:"#2150ec"},{default:f((()=>[_(g(N))])),_:1}),ue])),_:1}),m("div",te,[m("div",{class:b(Va.value?"pople_box box_active":"pople_box"),onClick:l[1]||(l[1]=e=>ll())},oe,2),(v(!0),r(y,null,V(ra.value,((e,s)=>(v(),r("div",{key:s,class:b(ya.value==s?"pople_box box_active":"pople_box"),onClick:a=>ll(s,e)},[ne,m("div",null,p(e),1),_(c,{trigger:"hover",placement:"right",width:180,"popper-class":"show_tags user_drop",teleported:!1},{reference:f((()=>[_(n,null,{default:f((()=>[_(g(L))])),_:1})])),default:f((()=>[m("div",{onClick:a=>{return l=s,u=e,pa.value=!0,wa.value=l,void(ka.value=u);var l,u}},ce,8,de),m("div",{onClick:e=>(async e=>{const{status:l}=await Q({group_id:e});1===l?B("删除分组成功"):D("删除分组失败"),a.push("/manage/company/personnelmanage"),al()})(s)},re,8,ve)])),_:2},1024),_(K,{modelValue:pa.value,"onUpdate:modelValue":l[3]||(l[3]=e=>pa.value=e),title:"修改名称",width:"500px","custom-class":"add_group",onClose:Ja},{footer:f((()=>[m("span",me,[_(d,{class:"bdc_btn",onClick:Ja},{default:f((()=>[pe])),_:1}),_(d,{type:"primary",onClick:Qa},{default:f((()=>[_e])),_:1})])])),default:f((()=>[_(j,{modelValue:ka.value,"onUpdate:modelValue":l[2]||(l[2]=e=>ka.value=e),placeholder:"请输入名称",maxlength:"10",type:"text","show-word-limit":""},null,8,["modelValue"])])),_:1},8,["modelValue"])],10,ie)))),128))]),_(K,{modelValue:ma.value,"onUpdate:modelValue":l[6]||(l[6]=e=>ma.value=e),title:"添加分组",width:"500px","custom-class":"add_group",onClose:Fa},{footer:f((()=>[m("span",fe,[_(d,{class:"bdc_btn",onClick:Fa},{default:f((()=>[ge])),_:1}),_(d,{type:"primary",onClick:l[5]||(l[5]=e=>(async e=>{const{status:a}=await F({name:e});1===a?B("分组添加成功"):D("分组添加失败"),Fa(),al(),ll()})(ha.value))},{default:f((()=>[be])),_:1})])])),default:f((()=>[_(j,{modelValue:ha.value,"onUpdate:modelValue":l[4]||(l[4]=e=>ha.value=e),placeholder:"请输入分组名称",maxlength:"10",type:"text","show-word-limit":""},null,8,["modelValue"])])),_:1},8,["modelValue"])]),m("div",ye,[m("div",Ve,[w(m("div",null,[va.value?(v(),r("div",we,[m("span",ke,p(ee.value),1),_(q,{href:"#icon-bianji",size:"16px",class:"bj",onClick:l[7]||(l[7]=e=>va.value=!1)})])):(v(),r("div",he,[_(j,{modelValue:ee.value,"onUpdate:modelValue":l[8]||(l[8]=e=>ee.value=e),"show-word-limit":"",maxlength:"30"},null,8,["modelValue"]),_(d,{type:"primary",onClick:Ra},{default:f((()=>[Ce])),_:1})]))],512),[[k,!ga.value]]),m("div",null,[w(_(d,{type:"info",plain:"",onClick:Sa},{default:f((()=>[xe])),_:1},512),[[k,!ga.value]]),_(d,{type:"primary",onClick:Na},{default:f((()=>[_(q,{href:"#icon-tianjia",size:"14px"}),je])),_:1})])]),m("div",null,[m("div",Ue,[_(A,{data:o.value},{empty:f((()=>[_(I)])),default:f((()=>[_(H,{prop:"user_name",label:"姓名",align:"center"}),_(H,{prop:"group_name",label:"部门",align:"center"}),_(H,{prop:"mobile",label:"电话",align:"center"}),_(H,{property:"user_status",label:"账号状态",align:"center"},{default:f((({row:e})=>[_(M,{modelValue:e.user_status,"onUpdate:modelValue":a=>e.user_status=a,"active-value":1,"inactive-value":0,onChange:a=>(async e=>{const{status:a}=await R({member_id:e});1===a?B("状态修改成功"):D("状态修改失败")})(e.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),_(H,{label:"操作",align:"center"},{default:f((({row:e})=>[m("div",ze,[_(d,{type:"text",onClick:a=>(async e=>{S({memberId:e.id}).then((e=>{1===e.status&&(Ca.value=e.body.group_ids,Za.value=e.body.role_ids,Ua.value=e.body.user_name,ja.value=e.body.mobile,fa.value=e.body.user_status,Ga.value=e.body.member_id)})),_a.value=!0;const{status:a,body:l}=await W();1===a&&(xa.value=l);const s=await Z();1===s.status&&(Wa.value=s.body)})(e)},{default:f((()=>[$e])),_:2},1032,["onClick"]),Ie,_(d,{type:"text",onClick:a=>(async e=>{const{status:a}=await T({member_id:e});1===a?B("删除人员成功"):D("删除人员失败"),ll(ba.value)})(e.id)},{default:f((()=>[Oe])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),_($,{page:s.value,"onUpdate:page":l[9]||(l[9]=e=>s.value=e),size:u.value,"onUpdate:size":l[10]||(l[10]=e=>u.value=e),total:t.value,onChange:l[11]||(l[11]=e=>al())},null,8,["page","size","total"])]),_(K,{modelValue:x.value,"onUpdate:modelValue":l[18]||(l[18]=e=>x.value=e),width:"500px","custom-class":"add_dialog",title:"添加人员",onClose:Ya},{default:f((()=>[m("div",Pe,[_(J,{class:"btn_tab"},{default:f((()=>[_(d,{class:b(1==E.value&&"btn_tab_active"),onClick:l[12]||(l[12]=e=>E.value=1)},{default:f((()=>[Ke])),_:1},8,["class"]),_(d,{class:b(2==E.value&&"btn_tab_active"),onClick:l[13]||(l[13]=e=>E.value=2)},{default:f((()=>[Ee])),_:1},8,["class"])])),_:1})]),1==E.value?(v(),r("div",qe,[Ne,m("div",Be,[_(P,{id:"qrImg",value:Ea.value,size:160,level:"H"},null,8,["value"])]),m("span",{class:"fleximg fresh_code",onClick:qa},[_(q,{href:"#icon-shuaxin",size:"14px"}),De]),m("div",He,[_(d,{type:"primary",onClick:Da},{default:f((()=>[Le])),_:1})])])):2==E.value?(v(),r("div",Me,[Ae,m("div",Fe,[_(X,{column:1},{default:f((()=>[_(G,{label:"邀请链接","class-name":"two"},{default:f((()=>[h(p(La.value),1)])),_:1})])),_:1})]),m("div",Je,[_(d,{type:"primary",onClick:l[14]||(l[14]=e=>(async e=>{try{await Aa(e),B("复制成功")}catch(a){D("该浏览器不支持自动复制")}Ya()})(La.value))},{default:f((()=>[Qe])),_:1})])])):(v(),r("div",Re,[Se,We,_(Oa,{ref_key:"num",ref:i,model:g(C),rules:g(el)},{default:f((()=>[m("div",Ze,[_(j,{modelValue:g(C).msg,"onUpdate:modelValue":l[15]||(l[15]=e=>g(C).msg=e),placeholder:"受邀人员姓名",class:"mb16"},null,8,["modelValue"]),_(Ia,{prop:"tel"},{default:f((()=>[_(j,{modelValue:g(C).tel,"onUpdate:modelValue":l[17]||(l[17]=e=>g(C).tel=e),placeholder:"受邀人员手机号"},{prepend:f((()=>[_($a,{modelValue:za.value,"onUpdate:modelValue":l[16]||(l[16]=e=>za.value=e)},{default:f((()=>[(v(!0),r(y,null,V(g(O),((e,a)=>(v(),z(Y,{key:a,label:"+"+e.value,value:e.value},{default:f((()=>[h(p(e.name+" +"+e.value),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["model","rules"]),m("div",Ge,[_(d,{type:"primary",onClick:Ya},{default:f((()=>[Te])),_:1})])]))])),_:1},8,["modelValue"]),_(K,{modelValue:_a.value,"onUpdate:modelValue":l[24]||(l[24]=e=>_a.value=e),width:"500px","custom-class":"del_dialog",title:"编辑人员",onClose:Xa},{default:f((()=>[m("div",Xe,[Ye,_(j,{modelValue:Ua.value,"onUpdate:modelValue":l[19]||(l[19]=e=>Ua.value=e)},null,8,["modelValue"])]),m("div",ea,[aa,_(j,{modelValue:ja.value,"onUpdate:modelValue":l[20]||(l[20]=e=>ja.value=e),disabled:""},null,8,["modelValue"])]),m("div",la,[sa,_($a,{modelValue:Ca.value,"onUpdate:modelValue":l[21]||(l[21]=e=>Ca.value=e),multiple:"",placeholder:"请选择分组（可多选）"},{default:f((()=>[(v(!0),r(y,null,V(xa.value,((e,a)=>(v(),z(Y,{key:a,label:e,value:Number(a)},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),m("div",ua,[ta,_($a,{modelValue:Za.value,"onUpdate:modelValue":l[22]||(l[22]=e=>Za.value=e),multiple:"",placeholder:"请选择角色（可多选）"},{default:f((()=>[(v(!0),r(y,null,V(Wa.value,((e,a)=>(v(),z(Y,{key:a,label:e,value:Number(a)},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),m("div",oa,[ia,_(M,{modelValue:fa.value,"onUpdate:modelValue":l[23]||(l[23]=e=>fa.value=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),m("div",na,[_(d,{class:"bdc_btn",onClick:Xa},{default:f((()=>[da])),_:1}),_(d,{type:"primary",onClick:Ta},{default:f((()=>[ca])),_:1})])])),_:1},8,["modelValue"])])])])}}},a(ra,l(ma))));var ra,ma,pa=E(va,[["__scopeId","data-v-be1603d2"]]);export{pa as default};
