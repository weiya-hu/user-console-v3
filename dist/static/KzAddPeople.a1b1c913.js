var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,d=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{K as s}from"./KzEmpty.61a513e5.js";import{f as u}from"./date.23847c74.js";import{K as i}from"./KzDialog.afc18edb.js";import{H as p,u as n,g as c,ax as m,r as v,o as f,I as y,a as w,w as b,J as _,X as h,B as g,a3 as V,c as k,a1 as C,a2 as j,av as x,aw as K,j as O,ad as z,$ as P,k as U}from"./vue.a499711c.js";import{_ as E,m as S,S as I,P as B,Q as D,R as F,e as q,E as M}from"./index.7f252a0e.js";import{_ as T}from"./KzCascader.6fd21cdd.js";import{K as A}from"./KzUpload.7b5bb174.js";const H=e=>(x("data-v-098cdc3c"),e=e(),K(),e),N={class:"dmp_table people_table"},R={class:"fcs"},J={key:0,class:"fcs"},Q=j("下载附件"),X={key:1,class:"line"},$=j("删除"),G={key:1,class:"fcs"},L={key:2,class:"fcs"},W=j("拒绝原因"),Y=H((()=>_("div",{class:"line"},null,-1))),Z=j("删除"),ee={key:3,class:"fcs"},ae=j("查看"),le=H((()=>_("div",{class:"line"},null,-1))),te=j("删除"),re={class:"fcc msg"},oe={class:"fcc"},de=j("我知道了");var se=E(p({name:"KzPeopleTable",props:{data:Array,details:String},emits:["select","del"],setup(e,{emit:a}){const l=e,t=S(),r=n((()=>t.state.addressHash)),o=e=>{a("select",e)},d=c(!1),p=c(""),j=c(""),x=c(!1),K=e=>{j.value=e,x.value=!0},O=()=>{a("del",j.value),x.value=!1},z=m();return(a,t)=>{const n=v("el-table-column"),c=v("el-link"),m=v("el-table"),j=v("el-button"),P=v("el-dialog");return f(),y("div",N,[w(m,{data:e.data,style:{width:"100%"},onSelectionChange:o},{empty:b((()=>[w(s)])),default:b((()=>[w(n,{type:"selection",width:"50"}),w(n,{property:"id",label:"ID",width:"100"}),w(n,{property:"group_name",label:"人群名称",width:"150"}),w(n,{property:"group_desc",label:"人群描述"}),w(n,{property:"status",label:"状态",width:"130"},{default:b((e=>[_("div",R,[_("div",{class:h(["status_dot",g(I)(e.row.status).className])},null,2),_("div",null,V(g(I)(e.row.status).text),1)])])),_:1}),w(n,{property:"address",label:"地区"},{default:b((e=>[_("div",null,V(g(B)(g(D)(e.row.province,e.row.city,e.row.district),g(r))),1)])),_:1}),w(n,{property:"count",label:"覆盖用户人数",width:"140"},{default:b((e=>[_("div",null,V(e.row.count),1)])),_:1}),w(n,{property:"money",label:"消耗金额 (元)",width:"160"},{default:b((e=>[_("div",null,V(Number(e.row.money).toFixed(2)),1)])),_:1}),w(n,{property:"create_time",label:"创建日期",width:"130"},{default:b((e=>[_("div",null,V(g(u)(new Date(e.row.create_time),"yyyy-MM-dd")),1)])),_:1}),w(n,{property:"source",label:"来源",width:"130"},{default:b((e=>[_("div",null,V(g(F)(e.row.source)),1)])),_:1}),w(n,{property:"user_name",label:"创建人",width:"130"}),w(n,{property:"source",label:"操作",width:"150",fixed:"right"},{default:b((e=>[1==e.row.status?(f(),y("div",J,[e.row.attachment?(f(),k(c,{key:0,type:"primary",href:e.row.attachment},{default:b((()=>[Q])),_:2},1032,["href"])):C("",!0),e.row.attachment?(f(),y("div",X)):C("",!0),w(c,{type:"primary",onClick:a=>K(e.row.id)},{default:b((()=>[$])),_:2},1032,["onClick"])])):C("",!0),2==e.row.status?(f(),y("div",G,"---")):C("",!0),3==e.row.status?(f(),y("div",L,[w(c,{type:"primary",onClick:a=>{return l=e.row.fail_reason,p.value=l,void(d.value=!0);var l}},{default:b((()=>[W])),_:2},1032,["onClick"]),Y,w(c,{type:"primary",onClick:a=>K(e.row.id)},{default:b((()=>[Z])),_:2},1032,["onClick"])])):C("",!0),4==e.row.status?(f(),y("div",ee,[w(c,{type:"primary",onClick:a=>{return t=e.row.id,void z.push(l.details+"?id="+t);var t}},{default:b((()=>[ae])),_:2},1032,["onClick"]),le,w(c,{type:"primary",onClick:a=>K(e.row.id)},{default:b((()=>[te])),_:2},1032,["onClick"])])):C("",!0)])),_:1})])),_:1},8,["data"]),w(P,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),title:"拒绝原因",width:"400px"},{footer:b((()=>[_("div",oe,[w(j,{type:"primary",onClick:t[0]||(t[0]=e=>d.value=!1)},{default:b((()=>[de])),_:1})])])),default:b((()=>[_("div",re,V(p.value),1)])),_:1},8,["modelValue"]),w(i,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=e=>x.value=e),msg:"确认删除这条数据吗?",onSure:O},null,8,["modelValue"])])}}}),[["__scopeId","data-v-098cdc3c"]]);const ue={class:"add_people"},ie={class:"fcs fjend"},pe=j("取消"),ne=j("提交");var ce=E(p({name:"KzAddPeople",props:{modelValue:Boolean},emits:["update:modelValue","success"],setup(e,{expose:s,emit:u}){const i=e,p=n({get:()=>i.modelValue,set:e=>{u("update:modelValue",e)}}),m=c({people:"",desc:"",addr:[],file:""}),h=c("none"),V=O({people:[{required:!0,message:"请输入人群名称",trigger:"blur"}],desc:[{required:!0,message:"请输入人群描述",trigger:"blur"}],addr:[{required:!0,message:"请选择地区",trigger:"change"}],file:[{validator:(e,a,l)=>{switch(h.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .doc、.docx、.pdf 格式的文件"));break;default:l()}},trigger:"change"}]}),C=c(),j=c(),x=c(!1),K=e=>{e?(h.value=e,m.value.file="",C.value.validateField("file",(()=>null))):(h.value="",C.value.clearValidate("file"))},E=e=>{var s;u("success",(s=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&d(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&d(e,l,a[l]);return e})({},m.value),a(s,l({path:e}))))},S=()=>{h.value="none",C.value.validate((e=>{if(!e)return!1;x.value=!0,m.value.file?j.value.submit():E("")}))},I=e=>{m.value.file="",h.value="none",j.value.clear(),x.value=!1,q("上传失败")},B=e=>{x.value?M.confirm("正在上传中，关闭弹窗可能会导致上传失败，是否继续关闭？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{})):e()},D=()=>{x.value=!1,h.value="none",j.value.clear(),C.value.resetFields(),u("update:modelValue",!1)};return s({addError:()=>{x.value=!1}}),(e,a)=>{const l=v("el-input"),t=v("el-form-item"),r=v("el-button"),o=v("el-form"),d=v("el-dialog"),s=z("loading");return f(),y("div",ue,[w(d,{modelValue:g(p),"onUpdate:modelValue":a[4]||(a[4]=e=>U(p)?p.value=e:null),title:"新建数据",width:"500px","before-close":B,onClose:D},{default:b((()=>[P((f(),k(o,{ref_key:"addFormRef",ref:C,class:"myform",model:m.value,rules:V},{default:b((()=>[w(t,{label:"人群名称",prop:"people"},{default:b((()=>[w(l,{modelValue:m.value.people,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value.people=e),placeholder:"请输入人群名称"},null,8,["modelValue"])])),_:1}),w(t,{label:"选择地区",prop:"addr"},{default:b((()=>[w(T,{modelValue:m.value.addr,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value.addr=e),type:"address"},null,8,["modelValue"])])),_:1}),w(t,{label:"人群描述",prop:"desc"},{default:b((()=>[w(l,{modelValue:m.value.desc,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value.desc=e),placeholder:"可对人群进行简单的描述",type:"textarea",maxlength:"150","show-word-limit":"",rows:"4",resize:"none"},null,8,["modelValue"])])),_:1}),w(t,{label:"上传附件",prop:"file"},{default:b((()=>[w(A,{ref_key:"upload",ref:j,modelValue:m.value.file,"onUpdate:modelValue":a[3]||(a[3]=e=>m.value.file=e),site:"dmp_attach",onChange:K,onError:I,onSuccess:E},null,8,["modelValue"])])),_:1}),_("div",ie,[w(r,{onClick:D},{default:b((()=>[pe])),_:1}),w(r,{type:"primary",onClick:S},{default:b((()=>[ne])),_:1})])])),_:1},8,["model","rules"])),[[s,x.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-bd5f6eb8"]]);export{se as K,ce as a};
