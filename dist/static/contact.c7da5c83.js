import{H as e,o as a,I as l,J as t,g as u,b as d,c as s,w as o,a as i,B as n,a2 as r,W as c,V as v,a1 as m,a0 as p,ac as f,P as _,aa as y,av as b,aw as g,q as h}from"./vue.fa004e33.js";import{K as k}from"./KzEmpty.21ade687.js";import{f as w}from"./date.23847c74.js";import{K as V}from"./KzDialog.df5ada75.js";import{x,_ as C,L as z,C as L,b as U,E as j,e as F,a2 as K}from"./index.743440f4.js";import{K as S}from"./KzPage.4cc4cb8e.js";import{a as M,b as R,d as I,c as B,e as E,f as O,g as H,h as T,i as q,j as D,k as N}from"./contact.003bb225.js";import"./kzkf.70bb183f.js";import"./tinymce.50e98bcc.js";const P=e({name:"Edit"}),$={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},A=[t("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),t("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var J=x(P,[["render",function(e,t,u,d,s,o){return a(),l("svg",$,A)}]]);const W={class:"upbox"},G={key:0,class:"upvideo up_lt"},Q=["src"],X={class:"fcc fc"},Y={class:"file_name"},Z={class:"upbox"},ee={class:"up_rt"},ae=["innerHTML"],le={key:0,class:"up_tip dfcolor fcs"},te=m("下载模板示例"),ue={key:1,class:"up_tip dfcolor"};var de=C(e({props:{modelValue:{default:""},exnameList:{default:()=>[".zip",".rar",".7z"]},downLink:{default:""},msg:{default:"可适当描述所处的行业现状，以及公司目前采取的运营、渠道、推广等多种获客方式，以便运营人员进一步了解熟悉您的所处的行业及需求，同时也为您提供更好的客户服务。"},type:{default:""},maxSize:{default:4}},emits:["update:modelValue","change","changeName"],setup(e,{expose:f,emit:_}){const y=e,b=u(),g=u({}),h=u(""),k=u("");u("");const w=u(""),V=u(),x=e=>{b.value.clearFiles(),b.value.handleStart(e[0]),j.value=void 0},C=u(),U=(e,a)=>{if(!e.name||"fail"===e.status)return;C.value=e;const l=e.name.lastIndexOf("."),t=e.name.substring(l);y.exnameList.indexOf(t)<0?_("change","type"):e.size&&e.size/1024/1024>y.maxSize?_("change","size"):(_("change",""),_("update:modelValue",e.raw),V.value=e.name,k.value=t,"video"===y.type&&(!w.value&&_("changeName",e.name.substring(0,l)),w.value=URL.createObjectURL(e.raw)))},j=u(),F=()=>{};return f({clear:()=>{b.value.clearFiles(),C.value=void 0,j.value=void 0,V.value=void 0,_("update:modelValue",""),URL.revokeObjectURL(w.value),w.value=""}}),(u,f)=>{const _=d("el-icon"),y=d("el-link"),k=d("el-upload");return a(),s(k,{ref_key:"upload",ref:b,drag:"",action:h.value,"auto-upload":!1,limit:1,multiple:!1,"show-file-list":!1,data:g.value,"on-exceed":x,"on-change":U,accept:e.exnameList.join(","),class:"my_upload"},{default:o((()=>[t("div",W,["video"===e.type&&e.modelValue?(a(),l("div",G,[t("video",{src:w.value},null,8,Q)])):(a(),l("div",{key:1,class:c(["fcc up_lt",e.modelValue?"hasfile":""])},[t("div",X,[i(_,null,{default:o((()=>[e.modelValue?(a(),s(n(z),{key:0})):(a(),s(n(L),{key:1}))])),_:1}),t("div",Y,r(V.value||"拖拽/点击上传"),1)])],2))])])),tip:o((()=>[t("div",Z,[v(u.$slots,"default",{},(()=>[t("div",ee,[t("div",{innerHTML:e.msg},null,8,ae),e.downLink?(a(),l("div",le,[i(y,{type:"primary",href:e.downLink,download:"模板.xlsx",onClick:F},{default:o((()=>[te])),_:1},8,["href"]),m("（上传附件大小不超过"+r(e.maxSize)+"M） ",1)])):p("",!0),e.downLink||"video"==e.type?p("",!0):(a(),l("div",ue," 附件支持 "+r(e.exnameList.join(" "))+"，大小不超过"+r(e.maxSize)+"M ",1))])]),!0)])])),_:3},8,["action","data","accept"])}}}),[["__scopeId","data-v-5bd2ef5e"]]);const se=e=>(b("data-v-a6a64c7a"),e=e(),g(),e),oe={class:"send_list"},ie={class:"flexb send_list_top"},ne=se((()=>t("div",null,"联系人",-1))),re={class:"flexr"},ce=m("查询"),ve=m("导入联系人"),me=m("分组管理"),pe=m(" 新建  "),fe={class:"dmp_table"},_e={class:"fcs"},ye=m("发送短信"),be=se((()=>t("div",{class:"line"},null,-1))),ge=m("修改"),he=se((()=>t("div",{class:"line"},null,-1))),ke=m("删除"),we={class:"type-tips"},Ve=se((()=>t("div",{class:"tips-nav"},[
t("span",null,"分组管理")],-1))),xe={class:"bbtns flexr"},Ce=m("添加"),ze={class:"dragbox"},Le={key:0,class:"typeAdd"},Ue={class:"cz"},je=m("取消"),Fe=m("确认"),Ke={class:"items"},Se={class:"txt"},Me={class:"handle"},Re={key:0,class:"fcs fjend imgicon"},Ie={style:{flex:"auto"}},Be=m("取消"),Ee=m("确定"),Oe={class:"flexl up_file"},He=se((()=>t("div",null,"上传附件",-1))),Te={class:"upload_pre"},qe={class:"up_file_describ"},De=se((()=>t("div",null,[
t("div",null,"1：下载模板，根据模板要求填写号码；"),
t("div",null,"2：上传填写后的模板文件；"),
t("div",null,"3：点击确认按钮；")],-1))),Ne=m("下载模板示例");var Pe=C(e({setup(e){const c=u(1),v=u(10),b=u(0),g=u(),x=u("none"),C=u(),z=u(),L=u(),P=u(!1),$=u(),A=u(),W=u({name:"",group_id:null,mobile:""}),G=u(),Q=u({addFile:""}),X=u({name:[{required:!0,message:"请输入姓名",trigger:"change"}],group_id:[{required:!0,message:"请选择分组",trigger:"change"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:U,trigger:"blur"}]}),Y=u({addFile:[{validator:(e,a,l)=>{switch(x.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .csv 格式的文件"));break;case"none":l(new Error("请添加文件"));break;default:l()}},trigger:"change"}]}),Z=async e=>{const a={current:c.value,size:v.value,str:e},{status:l,body:t}=await M(a);l&&(L.value=t.records,b.value=t.total)};Z();const ee=()=>{P.value=!0,g.value="新建联系人",le(),h((()=>{$.value.resetFields(),te()}))},ae=()=>{const e="编辑联系人"===g.value;$.value.validate((async a=>{if(a){const{status:a}=e?await R(W.value):await I(W.value);a&&(Z(),P.value=!1)}}))},le=async()=>{const{status:e,body:a}=await B();e&&(A.value=a)},te=()=>{W.value={name:"",group_id:null,mobile:""}},ue=u({}),se=u(""),Pe=u(!1),$e=u("rtl"),Ae=u(!1),Je=u(!1),We=u(!1),Ge=()=>{Pe.value=!1},Qe=()=>{Ae.value=!Ae.value},Xe=async()=>{const{status:e}=await H({name:se.value});e&&(le(),Ae.value=!1,se.value="")},Ye=async()=>{const e={id:ue.value},{status:a}=await T(e);a&&(le(),Je.value=!1)},Ze=async()=>{const e={name:se.value,id:ue.value},{status:a}=await q(e);a&&(le(),We.value=!1)},ea=u(),aa=u(!1),la=e=>{e?(x.value=e,Q.value.addFile="",G.value.validateField("addFile",(()=>null))):(x.value="",G.value.clearValidate("updateFile"))},ta=()=>{G.value.validate((async e=>{e&&(async()=>{const e=new FormData;e.append("file",Q.value.addFile);const{status:a,message:l}=await N(e);a?(aa.value=!1,j.alert(l,"提示",{confirmButtonText:"OK",callback:()=>{Z()}})):F(l)})()}))};return(e,u)=>{const h=d("el-input"),x=d("el-button"),U=d("KzIcon"),F=d("el-table-column"),M=d("el-link"),R=d("el-table"),I=d("el-form-item"),B=d("el-option"),H=d("el-select"),T=d("el-form"),q=d("el-icon"),N=d("el-tooltip"),ua=d("el-drawer");return a(),l("div",oe,[t("div",ie,[ne,t("div",re,[i(h,{modelValue:z.value,"onUpdate:modelValue":u[0]||(u[0]=e=>z.value=e),placeholder:"请输入姓名/电话号码搜索",class:"search_inpt",clearable:"",onInput:u[1]||(u[1]=()=>{!z.value&&Z()}),onKeydown:u[2]||(u[2]=f((e=>Z(z.value)),["enter"]))},null,8,["modelValue"]),i(x,{class:"bdc_btn",onClick:u[3]||(u[3]=e=>Z(z.value))},{default:o((()=>[ce])),_:1}),i(x,{class:"bdc_btn",onClick:u[4]||(u[4]=()=>{aa.value=!0,(async()=>{const e=await D();ea.value=URL.createObjectURL(e)})()})},{default:o((()=>[ve])),_:1}),i(x,{class:"bdc_btn",onClick:u[5]||(u[5]=()=>{Pe.value=!0,le()})},{default:o((()=>[me])),_:1}),i(x,{type:"primary",onClick:ee},{default:o((()=>[i(U,{href:"#icon-tianjia",size:"14px",color:"white",class:"add_need_icon"}),pe])),_:1})])]),t("div",fe,[i(R,{data:L.value,style:{width:"100%"}},{empty:o((()=>[i(k)])),default:o((()=>[i(F,{property:"name",label:"联系人姓名","min-width":"100"}),i(F,{property:"group_name",label:"联系人分组","min-width":"100"}),i(F,{property:"mobile",label:"电话号码","min-width":"120"}),i(F,{property:"create_time",label:"添加时间","min-width":"120"},{default:o((({row:e})=>[t("div",null,r(n(w)(new Date(e.create_time),"yyyy-MM-dd hh:mm")),1)])),_:1}),i(F,{label:"操作",fixed:"right",width:"250"},{default:o((({row:a})=>[t("div",_e,[i(M,{type:"primary",onClick:l=>e.$router.push("/product/notification/sms/addsend?mobile="+a.mobile+"&name="+a.name+"&contactId="+a.id)},{default:o((()=>[ye])),_:2},1032,["onClick"]),be,i(M,{type:"primary",onClick:e=>(e=>{le(),E({id:e.id}).then((e=>{W.value=e.body,g.value="编辑联系人",P.value=!0}))})(a)},{default:o((()=>[ge])),_:2},1032,["onClick"]),he,i(M,{type:"primary",onClick:e=>(e=>{j.confirm("是否确认删除联系人："+e.name,"操作提示",{showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"确认"}).then((async()=>{const{status:a}=await O({id:e.id});a&&Z()})).catch((()=>{}))})(a)},{default:o((()=>[ke])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),i(S,{page:c.value,"onUpdate:page":u[6]||(u[6]=e=>c.value=e),size:v.value,"onUpdate:size":u[7]||(u[7]=e=>v.value=e),total:b.value,onChange:u[8]||(u[8]=e=>Z(z.value))},null,8,["page","size","total"])]),i(V,{modelValue:P.value,"onUpdate:modelValue":u[12]||(u[12]=e=>P.value=e),width:"470px",title:g.value,onSure:ae,onClose:te},{default:o((()=>[i(T,{ref_key:"formRef",ref:$,model:W.value,rules:X.value},{default:o((()=>[i(I,{label:"联系人姓名",prop:"name"},{default:o((()=>[i(h,{modelValue:W.value.name,"onUpdate:modelValue":u[9]||(u[9]=e=>W.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),i(I,{label:"联系人分组",prop:"group_id"},{default:o((()=>[i(H,{modelValue:W.value.group_id,"onUpdate:modelValue":u[10]||(u[10]=e=>W.value.group_id=e),placeholder:"请选择分组",class:"group_select"},{default:o((()=>[(a(!0),l(_,null,y(A.value,(e=>(a(),s(B,{key:e.id,value:e.id,label:e.name},{default:o((()=>[m(r(e.name),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(I,{label:"   电话号码",prop:"mobile"},{default:o((()=>[i(h,{modelValue:W.value.mobile,"onUpdate:modelValue":u[11]||(u[11]=e=>W.value.mobile=e),placeholder:"请输入电话号码"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),t("div",we,[i(ua,{modelValue:Pe.value,"onUpdate:modelValue":u[14]||(u[14]=e=>Pe.value=e),direction:$e.value,size:"480"},{header:o((()=>[Ve])),default:o((()=>[t("div",xe,[i(x,{type:"primary",class:"bdc_btn type-add",plain:"",onClick:Qe},{default:o((()=>[Ce])),_:1})]),t("div",ze,[Ae.value?(a(),l("div",Le,[i(h,{modelValue:se.value,"onUpdate:modelValue":u[13]||(u[13]=e=>se.value=e),class:"type-input",clearable:"true"},null,8,["modelValue"]),t("div",Ue,[i(x,{type:"primary",class:"bdc_btn",plain:"",onClick:Qe},{default:o((()=>[je])),_:1}),i(x,{type:"primary",class:"",onClick:Xe},{default:o((()=>[Fe])),_:1})])])):p("",!0),(a(!0),l(_,null,y(A.value,((e,u)=>(a(),l("div",{key:e.id},[t("div",Ke,[t("div",Se,r(e.name),1),t("div",Me,[0!==u?(a(),l("div",Re,[i(N,{effect:"dark",content:"修改名称",placement:"bottom"},{default:o((()=>[i(q,{class:"chover",size:"18px","margin-right":"5px",onClick:a=>{return l=e,ue.value=l.id,se.value=l.name,void(We.value=!0);var l}},{default:o((()=>[i(n(J))])),_:2},1032,["onClick"])])),_:2},1024),i(N,{effect:"dark",content:"删除",placement:"bottom"},{default:o((()=>[i(q,{class:"chover",size:"18px","margin-right":"5px",onClick:a=>{return l=e,ue.value=l.id,se.value=l.name,void(Je.value=!0);var l}},{default:o((()=>[i(n(K))])),_:2},1032,["onClick"])])),_:2},1024)])):p("",!0)])])])))),128))])])),footer:o((()=>[t("div",Ie,[i(x,{onClick:Ge},{default:o((()=>[Be])),_:1}),i(x,{type:"primary",onClick:Ge},{default:o((()=>[Ee])),_:1})])])),_:1},8,["modelValue","direction"])]),i(V,{modelValue:We.value,"onUpdate:modelValue":u[16]||(u[16]=e=>We.value=e),title:"修改分组",width:"380px",onClose:u[17]||(u[17]=e=>se.value=""),onSure:Ze},{default:o((()=>[i(h,{modelValue:se.value,"onUpdate:modelValue":u[15]||(u[15]=e=>se.value=e),placeholder:"请输入分组名称"},null,8,["modelValue"])])),_:1},8,["modelValue"]),i(V,{modelValue:Je.value,"onUpdate:modelValue":u[18]||(u[18]=e=>Je.value=e),msg:"确认删除分组 “ "+se.value+" ” ?",onSure:Ye},null,8,["modelValue","msg"]),i(V,{modelValue:aa.value,"onUpdate:modelValue":u[20]||(u[20]=e=>aa.value=e),title:"导入联系人",width:"470px",onSure:ta,onClose:u[21]||(u[21]=()=>{C.value.clear()})},{default:o((()=>[t("div",Oe,[He,t("div",Te,[i(T,{ref_key:"upFileFormRef",ref:G,model:Q.value,rules:Y.value},{default:o((()=>[i(I,{prop:"addFile"},{default:o((()=>[i(de,{ref_key:"upFile",ref:C,modelValue:Q.value.addFile,"onUpdate:modelValue":u[19]||(u[19]=e=>Q.value.addFile=e),"exname-list":[".csv"],onChange:la},{default:o((()=>[t("div",qe,[De,i(M,{class:"download_url",type:"primary",href:ea.value,download:"模板.csv"},{default:o((()=>[Ne])),_:1},8,["href"])])])),_:1},8,["modelValue","exname-list"])])),_:1})])),_:1},8,["model","rules"])])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-a6a64c7a"]]);export{Pe as default};
