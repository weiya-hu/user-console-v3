import{K as e}from"./KzUpload.2bb38088.js";import{_ as a,X as l,e as t}from"./index.fde176ed.js";import{H as u,u as s,ay as d,j as r,g as o,r as i,ad as p,o as m,I as n,a as c,w as v,$ as A,J as f,B as g,k as b,a2 as V}from"./vue.a499711c.js";import{d as y}from"./custom.9ab95a7d.js";var w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAGNJREFUOE9jZCATMJKpjwGnxv///1czMDAwMTIyNmMzHJ/GqSANjIyM2YNM4////2sZGBgkkJxlB2UfQhJ7xsjI2Ar2AkwQGhhSBDS+gAXWUAwc9LiCBtY/WGCgy1M/yRFKwwCaai0PqJOyPgAAAABJRU5ErkJggg==";const h={class:"upload-users"},F={class:"myform"},z={class:"fcs fjend pb20"},U=V("取消"),_=V("提交");var x=a(u({name:"KzUpUser",props:{modelValue:{type:Boolean},type:null},emits:["update:modelValue","submitSuccess"],setup(a,{emit:u}){const V=a,w=s({get:()=>V.modelValue,set:e=>{u("update:modelValue",e)}});d();const x=r({title:[{required:!0,message:"请输入需求标题",trigger:"blur"}],desc:[{required:!0,message:"请输入需求描述",trigger:"blur"}],updateFile:[{validator:(e,a,l)=>{switch(k.value){case"size":l(new Error("请添加大小不超过4M的文件"));break;case"type":l(new Error("请添加 .zip、.rar、.7z 格式的文件"));break;default:l()}},trigger:"change"}]}),k=o("none"),j=o(),C=o(),J=o({title:"",desc:"",updateFile:""}),M=o(!1);o("");const S=()=>{j.value.resetFields(),C.value.clear(),u("update:modelValue",!1)},B=e=>{M.value?l().then((()=>{C.value.doAbort(),e()})).catch((()=>{})):e()},E=()=>{j.value.validate((e=>{if(!e)return!1;M.value=!0,J.value.updateFile?C.value.submit():R("")}))},G=e=>{e?(k.value=e,J.value.updateFile="",j.value.validateField("updateFile",(()=>null))):(k.value="",j.value.clearValidate("updateFile"))},K=e=>{J.value.updateFile="",k.value="none",C.value.clear(),M.value=!1,t("上传失败")},R=async e=>{const a=await y({attach_url:e,detail:J.value.desc,title:J.value.title},V.type);M.value=!1,1===a.status&&u("submitSuccess")};return(a,l)=>{const t=i("el-input"),u=i("el-form-item"),s=i("el-form"),d=i("el-button"),r=i("el-dialog"),o=p("loading");return m(),n("div",h,[c(r,{modelValue:g(w),"onUpdate:modelValue":l[3]||(l[3]=e=>b(w)?w.value=e:null),width:500,title:"创建需求","before-close":B,onClose:S},{default:v((()=>[A((m(),n("div",F,[c(s,{ref_key:"formRef",ref:j,model:J.value,rules:x,"label-width":"90px"},{default:v((()=>[c(u,{label:"需求标题",prop:"title"},{default:v((()=>[c(t,{modelValue:J.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>J.value.title=e),placeholder:"请输入需求标题"},null,8,["modelValue"])])),_:1}),c(u,{label:"需求描述",prop:"desc"},{default:v((()=>[c(t,{modelValue:J.value.desc,"onUpdate:modelValue":l[1]||(l[1]=e=>J.value.desc=e),type:"textarea",maxlength:"150","show-word-limit":"",rows:"5",resize:"none",placeholder:"简要描述您的具体需求，以及期望目标。"},null,8,["modelValue"])])),_:1}),c(u,{label:"文件上传",prop:"updateFile",style:{"margin-bottom":"20px"}},{default:v((()=>[c(e,{ref_key:"upload",ref:C,modelValue:J.value.updateFile,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value.updateFile=e),msg:"附件大小不超过4M<br/>支持.zip、.rar、.7z压缩包","exname-list":[".zip",".rar",".7z"],"max-size":4,onChange:G,onError:K,onSuccess:R},null,8,["modelValue","exname-list"])])),_:1})])),_:1},8,["model","rules"]),f("div",z,[c(d,{onClick:S},{default:v((()=>[U])),_:1}),c(d,{type:"primary",onClick:E},{default:v((()=>[_])),_:1})])])),[[o,M.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-54cbd238"]]);export{x as K,w as i};
