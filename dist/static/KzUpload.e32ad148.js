var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,u=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s;import{_ as i,L as d,C as r,J as n,e as c}from"./index.561f5261.js";import{H as v,g as p,r as m,o as f,c as y,w as b,J as g,I as h,a as x,B as _,a3 as k,X as L,W as O,a2 as w,a1 as j}from"./vue.a499711c.js";const z={class:"upbox"},U={key:0,class:"upvideo up_lt"},V=["src"],S={class:"fcc fc"},I={class:"file_name"},P={class:"upbox"},R={class:"up_rt"},C=["innerHTML"],M={key:0,class:"up_tip dfcolor fcs"},H=w("下载模板示例"),K={key:1,class:"up_tip dfcolor"};var A=i(v({name:"KzUpload",props:{modelValue:{default:""},exnameList:{default:()=>[".zip",".rar",".7z"]},downLink:{default:""},msg:{default:"可适当描述所处的行业现状，以及公司目前采取的运营、渠道、推广等多种获客方式，以便运营人员进一步了解熟悉您的所处的行业及需求，同时也为您提供更好的客户服务。"},type:{default:""},maxSize:{default:4},site:{default:""}},emits:["update:modelValue","change","error","success","changeName"],setup(e,{expose:i,emit:v}){const A=e,D=p(),F=p({}),J=p(""),N=p(""),T=p(""),B=p(""),E=e=>{D.value.clearFiles(),D.value.handleStart(e[0]),$.value=void 0},W=p(),X=(e,a)=>{if(!e.name||"fail"===e.status)return;W.value=e;const l=e.name.lastIndexOf("."),s=e.name.substring(l);A.exnameList.indexOf(s)<0?v("change","type"):e.size&&e.size/1024/1024>A.maxSize?v("change","size"):(v("change",""),v("update:modelValue",e.name),N.value=s,"video"===A.type&&(!B.value&&v("changeName",e.name.substring(0,l)),B.value=URL.createObjectURL(e.raw)))},$=p(),q=(e,i)=>{var d,r;$.value=(d=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&u(e,l,a[l]);if(s)for(var l of s(a))o.call(a,l)&&u(e,l,a[l]);return e})({},i),r={upUrl:T.value},a(d,l(r))),v("success",T.value)},G=(e,a,l)=>{Q(),c("上传失败"),v("error",e)},Q=()=>{D.value.clearFiles(),W.value=void 0,$.value=void 0,v("update:modelValue",""),URL.revokeObjectURL(B.value),B.value=""},Y=()=>{};return i({submit:()=>{var e,a,l;W.value&&((null==(e=$.value)?void 0:e.uid)===(null==(a=W.value)?void 0:a.uid)&&(null==(l=$.value)?void 0:l.upUrl)?v("success",$.value.upUrl):n({site:A.site?A.site:"video"===A.type?"official_video":"dmp_excel"}).then((e=>new Promise(((a,l)=>{1==e.status?(J.value=e.body.host,F.value={key:e.body.dir+"/"+e.body.uuid+N.value,OSSAccessKeyId:e.body.accessid,success_action_status:200,policy:e.body.policy,signature:e.body.signature,"Content-Disposition":"attachment; filename="+encodeURIComponent(A.modelValue)},a(e.body.host+"/"+e.body.dir+"/"+e.body.uuid+N.value)):l(e.message)})))).then((e=>{T.value=e,D.value.submit()})).catch((e=>{v("error",e)})))},clear:Q,doAbort:()=>{D.value.abort(W.value),c("取消上传")}}),(a,l)=>{const s=m("el-icon"),t=m("el-link"),o=m("el-upload");return f(),y(o,{ref_key:"upload",ref:D,drag:"",action:J.value,"auto-upload":!1,limit:1,multiple:!1,"show-file-list":!1,data:F.value,"on-exceed":E,"on-change":X,"on-success":q,"on-error":G,accept:e.exnameList.join(","),class:"my_upload"},{default:b((()=>[g("div",z,["video"===e.type&&e.modelValue?(f(),h("div",U,[g("video",{src:B.value},null,8,V)])):(f(),h("div",{key:1,class:L(["fcc up_lt",e.modelValue?"hasfile":""])},[g("div",S,[x(s,null,{default:b((()=>[e.modelValue?(f(),y(_(d),{key:0})):(f(),y(_(r),{key:1}))])),_:1}),g("div",I,k(e.modelValue||"拖拽/点击上传"),1)])],2))])])),tip:b((()=>[g("div",P,[O(a.$slots,"default",{},(()=>[g("div",R,[g("div",{innerHTML:e.msg},null,8,C),e.downLink?(f(),h("div",M,[x(t,{type:"primary",href:e.downLink,download:"模板.xlsx",onClick:Y},{default:b((()=>[H])),_:1},8,["href"]),w("（上传附件大小不超过"+k(e.maxSize)+"M） ",1)])):j("",!0),e.downLink||"video"==e.type?j("",!0):(f(),h("div",K," 附件支持 "+k(e.exnameList.join(" "))+"，大小不超过"+k(e.maxSize)+"M ",1))])]),!0)])])),_:3},8,["action","data","accept"])}}}),[["__scopeId","data-v-208d7b2a"]]);export{A as K};
